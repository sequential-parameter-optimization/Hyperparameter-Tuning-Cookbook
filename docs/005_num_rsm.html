<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hyperparameter Tuning Cookbook - 5&nbsp; Introduction: Numerical Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./006_num_gp.html" rel="next">
<link href="./004_spot_sklearn_optimization.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="Hyperparameter Tuning Cookbook - 5&nbsp; Introduction: Numerical Methods">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./005_num_rsm.html">Numerical Methods</a></li><li class="breadcrumb-item"><a href="./005_num_rsm.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction: Numerical Methods</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hyperparameter Tuning Cookbook</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/sequential-parameter-optimization/spotPython" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Hyperparameter-Tuning-Cookbook.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Optimization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001_optimization_surrogate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction: Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./002_awwe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Aircraft Wing Weight Example</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./003_scipy_optimize_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to <code>scipy.optimize</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./004_spot_sklearn_optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sequential Parameter Optimization: Using <code>scipy</code> Optimizers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Numerical Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005_num_rsm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction: Numerical Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./006_num_gp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Kriging (Gaussian Process Regression)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./007_num_spot_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction to spotPython</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./008_num_spot_multidim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multi-dimensional Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./009_num_spot_anisotropic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Isotropic and Anisotropic Kriging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./010_num_spot_sklearn_surrogate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Using <code>sklearn</code> Surrogates in <code>spotPython</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011_num_spot_sklearn_gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Sequential Parameter Optimization: Gaussian Process Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012_num_spot_ei.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Expected Improvement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./013_num_spot_noisy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Handling Noise</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./014_num_spot_ocba.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Optimal Computational Budget Allocation in <code>Spot</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./015_num_spot_correlation_p.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Kriging with Varying Correlation-p</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Hyperparameter Tuning with River</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./022_spot_hpt_river.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">HPT: River</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./023_spot_river_gui.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The spotriver GUI</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./024_spot_hpt_river_friedman_hatr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><code>river</code> Hyperparameter Tuning: Hoeffding Adaptive Tree Regressor with Friedman Drift Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./025_spot_hpt_river_friedman_amfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title"><code>river</code> Hyperparameter Tuning: Mondrian Tree Regressor with Friedman Drift Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Hyperparameter Tuning with PyTorch Lightning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./031_spot_lightning_linear_diabetes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">HPT PyTorch Lightning: Diabetes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./032_spot_lightning_rnn_diabetes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">HPT PyTorch Lightning: Diabetes Using a Recurrent Neural Network</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./033_spot_lightning_linear_sensitive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">HPT PyTorch Lightning: User Specified Data Set and Regression Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./034_spot_lightning_xai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Explainable AI with SpotPython and Pytorch</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./035_spot_lightning_transformer_diabetes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">HPT PyTorch Lightning Transformer: Diabetes</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_01_intro_to_notebooks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Introduction to Jupyter Notebook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_02_git_intro_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Git Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_03_python_intro_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Python Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_04_spot_doc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Documentation of the Sequential Parameter Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#response-surface-methods-what-is-rsm" id="toc-response-surface-methods-what-is-rsm" class="nav-link active" data-scroll-target="#response-surface-methods-what-is-rsm"><span class="header-section-number">5.1</span> Response Surface Methods: What is RSM?</a>
  <ul class="collapse">
  <li><a href="#visualization-problems-in-practice" id="toc-visualization-problems-in-practice" class="nav-link" data-scroll-target="#visualization-problems-in-practice"><span class="header-section-number">5.1.1</span> Visualization: Problems in Practice</a></li>
  <li><a href="#rsm-strategies" id="toc-rsm-strategies" class="nav-link" data-scroll-target="#rsm-strategies"><span class="header-section-number">5.1.2</span> RSM: Strategies</a></li>
  <li><a href="#rsm-noise-in-the-empirical-model" id="toc-rsm-noise-in-the-empirical-model" class="nav-link" data-scroll-target="#rsm-noise-in-the-empirical-model"><span class="header-section-number">5.1.3</span> RSM: Noise in the Empirical Model</a></li>
  <li><a href="#rsm-natural-and-coded-variables" id="toc-rsm-natural-and-coded-variables" class="nav-link" data-scroll-target="#rsm-natural-and-coded-variables"><span class="header-section-number">5.1.4</span> RSM: Natural and Coded Variables</a></li>
  <li><a href="#rsm-low-order-polynomials" id="toc-rsm-low-order-polynomials" class="nav-link" data-scroll-target="#rsm-low-order-polynomials"><span class="header-section-number">5.1.5</span> RSM Low-order Polynomials</a></li>
  </ul></li>
  <li><a href="#first-order-models-main-effects-model" id="toc-first-order-models-main-effects-model" class="nav-link" data-scroll-target="#first-order-models-main-effects-model"><span class="header-section-number">5.2</span> First-Order Models (Main Effects Model)</a>
  <ul class="collapse">
  <li><a href="#first-order-model-properties" id="toc-first-order-model-properties" class="nav-link" data-scroll-target="#first-order-model-properties"><span class="header-section-number">5.2.1</span> First-Order Model Properties</a></li>
  <li><a href="#first-order-model-with-interactions-in-python" id="toc-first-order-model-with-interactions-in-python" class="nav-link" data-scroll-target="#first-order-model-with-interactions-in-python"><span class="header-section-number">5.2.2</span> First-order Model with Interactions in python</a></li>
  <li><a href="#observations-first-order-model-with-interactions" id="toc-observations-first-order-model-with-interactions" class="nav-link" data-scroll-target="#observations-first-order-model-with-interactions"><span class="header-section-number">5.2.3</span> Observations: First-Order Model with Interactions</a></li>
  </ul></li>
  <li><a href="#second-order-models" id="toc-second-order-models" class="nav-link" data-scroll-target="#second-order-models"><span class="header-section-number">5.3</span> Second-Order Models</a>
  <ul class="collapse">
  <li><a href="#second-order-models-properties" id="toc-second-order-models-properties" class="nav-link" data-scroll-target="#second-order-models-properties"><span class="header-section-number">5.3.1</span> Second-Order Models: Properties</a></li>
  <li><a href="#example-stationary-ridge" id="toc-example-stationary-ridge" class="nav-link" data-scroll-target="#example-stationary-ridge"><span class="header-section-number">5.3.2</span> Example: Stationary Ridge</a></li>
  <li><a href="#observations-second-order-model-ridge" id="toc-observations-second-order-model-ridge" class="nav-link" data-scroll-target="#observations-second-order-model-ridge"><span class="header-section-number">5.3.3</span> Observations: Second-Order Model (Ridge)</a></li>
  <li><a href="#example-rising-ridge" id="toc-example-rising-ridge" class="nav-link" data-scroll-target="#example-rising-ridge"><span class="header-section-number">5.3.4</span> Example: Rising Ridge</a></li>
  <li><a href="#summary-rising-ridge" id="toc-summary-rising-ridge" class="nav-link" data-scroll-target="#summary-rising-ridge"><span class="header-section-number">5.3.5</span> Summary: Rising Ridge</a></li>
  <li><a href="#falling-ridge" id="toc-falling-ridge" class="nav-link" data-scroll-target="#falling-ridge"><span class="header-section-number">5.3.6</span> Falling Ridge</a></li>
  <li><a href="#saddle-point" id="toc-saddle-point" class="nav-link" data-scroll-target="#saddle-point"><span class="header-section-number">5.3.7</span> Saddle Point</a></li>
  <li><a href="#interpretation-saddle-points" id="toc-interpretation-saddle-points" class="nav-link" data-scroll-target="#interpretation-saddle-points"><span class="header-section-number">5.3.8</span> Interpretation: Saddle Points</a></li>
  <li><a href="#summary-ridge-analysis" id="toc-summary-ridge-analysis" class="nav-link" data-scroll-target="#summary-ridge-analysis"><span class="header-section-number">5.3.9</span> Summary: Ridge Analysis</a></li>
  </ul></li>
  <li><a href="#general-rsm-models" id="toc-general-rsm-models" class="nav-link" data-scroll-target="#general-rsm-models"><span class="header-section-number">5.4</span> General RSM Models</a>
  <ul class="collapse">
  <li><a href="#ordinary-least-squares" id="toc-ordinary-least-squares" class="nav-link" data-scroll-target="#ordinary-least-squares"><span class="header-section-number">5.4.1</span> Ordinary Least Squares</a></li>
  </ul></li>
  <li><a href="#designs" id="toc-designs" class="nav-link" data-scroll-target="#designs"><span class="header-section-number">5.5</span> Designs</a>
  <ul class="collapse">
  <li><a href="#different-designs" id="toc-different-designs" class="nav-link" data-scroll-target="#different-designs"><span class="header-section-number">5.5.1</span> Different Designs</a></li>
  </ul></li>
  <li><a href="#rsm-experimentation" id="toc-rsm-experimentation" class="nav-link" data-scroll-target="#rsm-experimentation"><span class="header-section-number">5.6</span> RSM Experimentation</a>
  <ul class="collapse">
  <li><a href="#first-step" id="toc-first-step" class="nav-link" data-scroll-target="#first-step"><span class="header-section-number">5.6.1</span> First Step</a></li>
  <li><a href="#second-step" id="toc-second-step" class="nav-link" data-scroll-target="#second-step"><span class="header-section-number">5.6.2</span> Second Step</a></li>
  <li><a href="#third-step" id="toc-third-step" class="nav-link" data-scroll-target="#third-step"><span class="header-section-number">5.6.3</span> Third Step</a></li>
  </ul></li>
  <li><a href="#rsm-review-and-general-considerations" id="toc-rsm-review-and-general-considerations" class="nav-link" data-scroll-target="#rsm-review-and-general-considerations"><span class="header-section-number">5.7</span> RSM: Review and General Considerations</a>
  <ul class="collapse">
  <li><a href="#historical-considerations-about-rsm" id="toc-historical-considerations-about-rsm" class="nav-link" data-scroll-target="#historical-considerations-about-rsm"><span class="header-section-number">5.7.1</span> Historical Considerations about RSM</a></li>
  <li><a href="#status-quo" id="toc-status-quo" class="nav-link" data-scroll-target="#status-quo"><span class="header-section-number">5.7.2</span> Status Quo</a></li>
  <li><a href="#the-role-of-statistics" id="toc-the-role-of-statistics" class="nav-link" data-scroll-target="#the-role-of-statistics"><span class="header-section-number">5.7.3</span> The Role of Statistics</a></li>
  <li><a href="#new-rsm-is-needed-dace" id="toc-new-rsm-is-needed-dace" class="nav-link" data-scroll-target="#new-rsm-is-needed-dace"><span class="header-section-number">5.7.4</span> New RSM is needed: DACE</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">5.8</span> Exercises</a></li>
  <li><a href="#jupyter-notebook" id="toc-jupyter-notebook" class="nav-link" data-scroll-target="#jupyter-notebook"><span class="header-section-number">5.9</span> Jupyter Notebook</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./005_num_rsm.html">Numerical Methods</a></li><li class="breadcrumb-item"><a href="./005_num_rsm.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction: Numerical Methods</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction: Numerical Methods</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- bart21mSlides2022Lec01-03 -->
<p>This part deals with numerical implementations of optimization methods. The goal is to understand the implementation of optimization methods and to solve real-world problems numerically and efficiently. We will focus on the implementation of surrogate models, because they are the most efficient way to solve real-world problems.</p>
<p>Starting point is the well-established response surface methodology. It will be extended to the design and analysis of computer experiments (DACE). The DACE methodology is a modern extension of the response surface methodology. It is based on the use of surrogate models, which are used to replace the real-world problem with a simpler problem. The simpler problem is then solved numerically. The solution of the simpler problem is then used to solve the real-world problem.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Numerical methods: Goals
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Understand implementation of optimization methods</li>
<li>Solve real-world problems numerically and efficiently</li>
</ul>
</div>
</div>
<section id="response-surface-methods-what-is-rsm" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="response-surface-methods-what-is-rsm"><span class="header-section-number">5.1</span> Response Surface Methods: What is RSM?</h2>
<p>Response Surface Methods (RSM) refer to a collection of statistical and mathematical tools that are valuable for developing, improving, and optimizing processes. The overarching theme of RSM involves studying how input variables that control a product or process can potentially influence a response that measures performance or quality characteristics.</p>
<p>The advantages of RSM include a rich literature, well-established methods often used in manufacturing, the importance of careful experimental design combined with a well-understood model, and the potential to add significant value to scientific inquiry, process refinement, optimization, and more. However, there are also drawbacks to RSM, such as the use of simple and crude surrogates, the hands-on nature of the methods, and the limitation of local methods.</p>
<p>RSM is related to various fields, including Design of Experiments (DoE), quality management, reliability, and productivity. Its applications are widespread in industry and manufacturing, focusing on designing, developing, and formulating new products and improving existing ones, as well as from laboratory research. RSM is commonly applied in domains such as materials science, manufacturing, applied chemistry, climate science, and many others.</p>
<p>An example of RSM involves studying the relationship between a response variable, such as yield (<span class="math inline">\(y\)</span>) in a chemical process, and two process variables: reaction time (<span class="math inline">\(\xi_1\)</span>) and reaction temperature (<span class="math inline">\(\xi_2\)</span>). The provided code illustrates this scenario, following a variation of the so-called “banana function.”</p>
<p>In the context of visualization, RSM offers the choice between 3D plots and contour plots. In a 3D plot, the independent variables <span class="math inline">\(\xi_1\)</span> and <span class="math inline">\(\xi_2\)</span> are represented, with <span class="math inline">\(y\)</span> as the dependent variable.</p>
<div id="28a69d68" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun_rosen(x1, x2):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x1<span class="op">-</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">*</span>(x2<span class="op">-</span>x1<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, <span class="fl">0.05</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">3.0</span>, <span class="fl">0.05</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>zs <span class="op">=</span> np.array(fun_rosen(np.ravel(X), np.ravel(Y)))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> zs.reshape(X.shape)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X, Y, Z)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'X1'</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'X2'</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">'Y'</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-2-output-1.png" width="410" height="397" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>contour plot example:
<ul>
<li><span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are the independent variables</li>
<li><span class="math inline">\(y\)</span> is the dependent variable</li>
</ul></li>
</ul>
<div id="f58e6b2d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">3.0</span>, delta)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fun_rosen(X1, X2)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax.contour(X1, X2, Y , <span class="dv">50</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>ax.clabel(CS, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Rosenbrock's Banana Function"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Text(0.5, 1.0, "Rosenbrock's Banana Function")</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-3-output-2.png" width="582" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Visual inspection: yield is optimized near <span class="math inline">\((\xi_1. \xi_2)\)</span></li>
</ul>
<section id="visualization-problems-in-practice" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="visualization-problems-in-practice"><span class="header-section-number">5.1.1</span> Visualization: Problems in Practice</h3>
<ul>
<li>True response surface is unknown in practice</li>
<li>When yield evaluation is not as simple as a toy banana function, but a process requiring care to monitor, reconfigure and run, it’s far too expensive to observe over a dense grid</li>
<li>And, measuring yield may be a noisy/inexact process</li>
<li>That’s where stats (RSM) comes in</li>
</ul>
</section>
<section id="rsm-strategies" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="rsm-strategies"><span class="header-section-number">5.1.2</span> RSM: Strategies</h3>
<ul>
<li><p>RSMs consist of experimental strategies for</p></li>
<li><p><strong>exploring</strong> the space of the process (i.e., independent/input) variables (above <span class="math inline">\(\xi_1\)</span> and <span class="math inline">\(\xi2)\)</span></p></li>
<li><p>empirical statistical <strong>modeling</strong> targeted toward development of an appropriate approximating relationship between the response (yield) and process variables local to a study region of interest</p></li>
<li><p><strong>optimization</strong> methods for sequential refinement in search of the levels or values of process variables that produce desirable responses (e.g., that maximize yield or explain variation)</p></li>
<li><p>RSM used for fitting an Empirical Model</p></li>
<li><p>True response surface driven by an unknown physical mechanism</p></li>
<li><p>Observations corrupted by noise</p></li>
<li><p>Helpful: fit an empirical model to output collected under different process configurations</p></li>
<li><p>Consider response <span class="math inline">\(Y\)</span> that depends on controllable input variables <span class="math inline">\(\xi_1, \xi_2, \ldots, \xi_m\)</span></p></li>
<li><p>RSM: Equations of the Empirical Model</p>
<ul>
<li><span class="math inline">\(Y=f(\xi_1, \xi_2, \ldots, \xi_m) + \epsilon\)</span></li>
<li><span class="math inline">\(\mathbb{E}\{Y\} = \eta = f(\xi1_1, \xi_2, \ldots, \xi_m)\)</span></li>
<li><span class="math inline">\(\epsilon\)</span> is treated as zero mean idiosyncratic noise possibly representing
<ul>
<li>inherent variation, or</li>
<li>the effect of other systems or</li>
<li>variables not under our purview at this time</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="rsm-noise-in-the-empirical-model" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="rsm-noise-in-the-empirical-model"><span class="header-section-number">5.1.3</span> RSM: Noise in the Empirical Model</h3>
<ul>
<li>Typical simplifying assumption: <span class="math inline">\(\epsilon \sim N(0,\sigma^2)\)</span></li>
<li>We seek estimates for <span class="math inline">\(f\)</span> and <span class="math inline">\(\sigma^2\)</span> from noisy observations <span class="math inline">\(Y\)</span> at inputs <span class="math inline">\(\xi\)</span></li>
</ul>
</section>
<section id="rsm-natural-and-coded-variables" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="rsm-natural-and-coded-variables"><span class="header-section-number">5.1.4</span> RSM: Natural and Coded Variables</h3>
<ul>
<li>Inputs <span class="math inline">\(\xi_1, \xi_2, \ldots, \xi_m\)</span> called <strong>natural variables</strong>:
<ul>
<li>expressed in natural units of measurement, e.g., degrees Celsius, pounds per square inch (psi), etc.</li>
</ul></li>
<li>Transformed to <strong>coded variables</strong> <span class="math inline">\(x_1, x_2, \ldots, x_m\)</span>:
<ul>
<li>to mitigate hassles and confusion that can arise when working with a multitude of scales of measurement</li>
</ul></li>
<li>Typical <strong>Transformations</strong> offering dimensionless inputs <span class="math inline">\(x_1, x_2, \ldots, x_m\)</span>
<ul>
<li>in the unit cube, or</li>
<li>scaled to have a mean of zero and standard deviation of one, are common choices.</li>
</ul></li>
<li>Empirical model becomes <span class="math inline">\(\eta = f(x_1, x_2, \ldots, x_m)\)</span></li>
</ul>
</section>
<section id="rsm-low-order-polynomials" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="rsm-low-order-polynomials"><span class="header-section-number">5.1.5</span> RSM Low-order Polynomials</h3>
<ul>
<li>Low-order polynomial make the following simplifying Assumptions
<ul>
<li>Learning about <span class="math inline">\(f\)</span> is lots easier if we make some simplifying approximations</li>
<li>Appealing to <strong>Taylor’s theorem</strong>, a low-order polynomial in a small, localized region of the input (<span class="math inline">\(x\)</span>) space is one way forward</li>
<li>Classical RSM:
<ul>
<li>disciplined application of <strong>local analysis</strong> and</li>
<li><strong>sequential refinement</strong> of locality through conservative extrapolation</li>
</ul></li>
<li>Inherently a <strong>hands-on process</strong></li>
</ul></li>
</ul>
</section>
</section>
<section id="first-order-models-main-effects-model" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="first-order-models-main-effects-model"><span class="header-section-number">5.2</span> First-Order Models (Main Effects Model)</h2>
<ul>
<li><strong>First-order model</strong> (sometimes called main effects model) useful in parts of the input space where it’s believed that there’s little curvature in <span class="math inline">\(f\)</span>: <span class="math display">\[\eta = \beta_0 + \beta_1 x_1 + \beta_2 x_2 \]</span></li>
<li>For example: <span class="math display">\[\eta = 50 + 8 x_1 + 3x_2\]</span></li>
<li>In practice, such a surface would be obtained by fitting a model to the outcome of a designed experiment</li>
<li>First-Order Model in python Evaluated on a Grid</li>
<li>Evaluate model on a grid in a double-unit square centered at the origin</li>
<li>Coded units are chosen arbitrarily, although one can imagine deploying this approximating function nearby <span class="math inline">\(x^{(0)} = (0,0)\)</span></li>
</ul>
<div id="39341db2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun_1(x1,x2):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">8</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="14898d55" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">1.0</span>, delta)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">1.0</span>, delta)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fun_1(X1,X2)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax.contour(X1, X2, Y)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ax.clabel(CS, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'First Order Model: $50 + 8x_1 + 3x_2$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Text(0.5, 1.0, 'First Order Model: $50 + 8x_1 + 3x_2$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-5-output-2.png" width="590" height="432" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="first-order-model-properties" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="first-order-model-properties"><span class="header-section-number">5.2.1</span> First-Order Model Properties</h3>
<ul>
<li>First-order model in 2d traces out a <strong>plane</strong> in <span class="math inline">\(y \times (x_1, x_2)\)</span> space</li>
<li>Only be appropriate for the most trivial of response surfaces, even when applied in a highly localized part of the input space</li>
<li>Adding <strong>curvature</strong> is key to most applications:
<ul>
<li>First-order model with <strong>interactions</strong> induces limited degree of curvature via different rates of change of <span class="math inline">\(y\)</span> as <span class="math inline">\(x_1\)</span> is varied for fixed <span class="math inline">\(x_2\)</span>, and vice versa: <span class="math display">\[\eta = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{12} x_{12} \]</span></li>
</ul></li>
<li>For example <span class="math inline">\(\eta = 50+8x_1+3x_2-4x_1x_2\)</span></li>
</ul>
</section>
<section id="first-order-model-with-interactions-in-python" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="first-order-model-with-interactions-in-python"><span class="header-section-number">5.2.2</span> First-order Model with Interactions in python</h3>
<ul>
<li>Code below facilitates evaluations for pairs <span class="math inline">\((x_1, x_2)\)</span></li>
<li>Responses may be observed over a mesh in the same double-unit square</li>
</ul>
<div id="1d8b377d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun_11(x1,x2):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">8</span> <span class="op">*</span> x1 <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x2 <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> x1 <span class="op">*</span> x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3aac73ef" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fun_11(X1,X2)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax.contour(X1, X2, Y, <span class="dv">20</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>ax.clabel(CS, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'First Order Model with Interactions'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>Text(0.5, 1.0, 'First Order Model with Interactions')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-7-output-2.png" width="582" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-first-order-model-with-interactions" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="observations-first-order-model-with-interactions"><span class="header-section-number">5.2.3</span> Observations: First-Order Model with Interactions</h3>
<ul>
<li>Mean response <span class="math inline">\(\eta\)</span> is increasing marginally in both <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, or conditional on a fixed value of the other until <span class="math inline">\(x_1\)</span> is 0.75</li>
<li>Rate of increase slows as both coordinates grow simultaneously since the coefficient in front of the interaction term <span class="math inline">\(x_1 x_2\)</span> is negative</li>
<li>Compared to the first-order model (without interactions): surface is far more useful locally</li>
<li>Least squares regressions often flag up significant interactions when fit to data collected on a design far from local optima</li>
</ul>
</section>
</section>
<section id="second-order-models" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="second-order-models"><span class="header-section-number">5.3</span> Second-Order Models</h2>
<ul>
<li><p>Second-order model may be appropriate near local optima where <span class="math inline">\(f\)</span> would have substantial curvature: <span class="math display">\[\eta = \beta_0 + \beta_1 x_1 + \beta_2 x_2  + \beta_{11}x_1^2 + \beta_{22}x^2 + \beta_{12} x_1 x_2\]</span></p></li>
<li><p>For example <span class="math display">\[\eta = 50 + 8 x_1 + 3x_2 - 7x_1^2 - 3 x_2^2 - 4x_1x_2\]</span></p></li>
<li><p>Implementation of the Second-Order Model as <code>fun_2()</code>.</p></li>
</ul>
<div id="7674c9cc" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun_2(x1,x2):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">8</span> <span class="op">*</span> x1 <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x2 <span class="op">-</span> <span class="dv">7</span> <span class="op">*</span> x1<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>x2<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">4</span> <span class="op">*</span> x1 <span class="op">*</span> x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bc620a0b" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fun_2(X1,X2)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax.contour(X1, X2, Y, <span class="dv">20</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ax.clabel(CS, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Second Order Model with Interactions. Maximum near about $(0.6,0.2)$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Text(0.5, 1.0, 'Second Order Model with Interactions. Maximum near about $(0.6,0.2)$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-9-output-2.png" width="601" height="432" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="second-order-models-properties" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="second-order-models-properties"><span class="header-section-number">5.3.1</span> Second-Order Models: Properties</h3>
<ul>
<li>Not all second-order models would have a single stationary point (in RSM jargon called “a simple maximum”)</li>
<li>In “yield maximizing” setting we’re presuming response surface is <strong>concave</strong> down from a global viewpoint
<ul>
<li>even though local dynamics may be more nuanced</li>
</ul></li>
<li>Exact criteria depend upon the eigenvalues of a certain matrix built from those coefficients</li>
<li>Box and Draper (2007) provide a diagram categorizing all of the kinds of second-order surfaces in RSM analysis, where finding local maxima is the goal</li>
</ul>
</section>
<section id="example-stationary-ridge" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="example-stationary-ridge"><span class="header-section-number">5.3.2</span> Example: Stationary Ridge</h3>
<ul>
<li>Example set of coefficients describing what’s called a <strong>stationary ridge</strong> is provided by the code below</li>
</ul>
<div id="b8339a8d" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun_ridge(x1, x2):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">80</span> <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">8</span><span class="op">*</span>x2 <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>x1<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">12</span><span class="op">*</span>x2<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">12</span><span class="op">*</span>x1<span class="op">*</span>x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f363c515" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fun_ridge(X1,X2)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax.contour(X1, X2, Y, <span class="dv">20</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>ax.clabel(CS, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Example of a stationary ridge'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Text(0.5, 1.0, 'Example of a stationary ridge')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-11-output-2.png" width="582" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-second-order-model-ridge" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="observations-second-order-model-ridge"><span class="header-section-number">5.3.3</span> Observations: Second-Order Model (Ridge)</h3>
<ul>
<li><strong>Ridge</strong>: a whole line of stationary points corresponding to maxima</li>
<li>Situation means that the practitioner has some flexibility when it comes to optimizing:
<ul>
<li>can choose the precise setting of <span class="math inline">\((x_1, x_2)\)</span> either arbitrarily or (more commonly) by consulting some tertiary criteria</li>
</ul></li>
</ul>
</section>
<section id="example-rising-ridge" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="example-rising-ridge"><span class="header-section-number">5.3.4</span> Example: Rising Ridge</h3>
<ul>
<li>An example of a rising ridge is implemented by the code below.</li>
</ul>
<div id="e9489aff" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun_ridge_rise(x1, x2):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> <span class="dv">80</span> <span class="op">-</span> <span class="dv">4</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>x2 <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>x1<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">12</span><span class="op">*</span>x2<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">12</span><span class="op">*</span>x1<span class="op">*</span>x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="16a869e7" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fun_ridge_rise(X1,X2)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax.contour(X1, X2, Y, <span class="dv">20</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>ax.clabel(CS, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Rising ridge: $</span><span class="ch">\\</span><span class="st">eta = 80 + 4x_1 + 8x_2 - 3x_1^2 - 12x_2^2 - 12x_1x_2$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Text(0.5, 1.0, 'Rising ridge: $\\eta = 80 + 4x_1 + 8x_2 - 3x_1^2 - 12x_2^2 - 12x_1x_2$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-13-output-2.png" width="582" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-rising-ridge" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="summary-rising-ridge"><span class="header-section-number">5.3.5</span> Summary: Rising Ridge</h3>
<ul>
<li>The stationary point is remote to the study region</li>
<li>Ccontinuum of (local) stationary points along any line going through the 2d space, excepting one that lies directly on the ridge</li>
<li>Although estimated response will increase while moving along the axis of symmetry toward its stationary point, this situation indicates
<ul>
<li>either a poor fit by the approximating second-order function, or</li>
<li>that the study region is not yet precisely in the vicinity of a local optima—often both.</li>
</ul></li>
</ul>
</section>
<section id="falling-ridge" class="level3" data-number="5.3.6">
<h3 data-number="5.3.6" class="anchored" data-anchor-id="falling-ridge"><span class="header-section-number">5.3.6</span> Falling Ridge</h3>
<ul>
<li>Inversion of a rising ridge is a falling ridge</li>
<li>Similarly indicating one is far from local optima, except that the response decreases as you move toward the stationary point</li>
<li>Finding a falling ridge system can be a back-to-the-drawing-board affair.</li>
</ul>
</section>
<section id="saddle-point" class="level3" data-number="5.3.7">
<h3 data-number="5.3.7" class="anchored" data-anchor-id="saddle-point"><span class="header-section-number">5.3.7</span> Saddle Point</h3>
<ul>
<li>Finally, we can get what’s called a saddle or minimax system.</li>
</ul>
<div id="b13d32e3" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun_saddle(x1, x2):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">80</span> <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>x1 <span class="op">+</span> <span class="dv">8</span><span class="op">*</span>x2 <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>x2<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">12</span><span class="op">*</span>x1<span class="op">*</span>x2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="21556a2a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">2.0</span>, delta)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>X1, X2 <span class="op">=</span> np.meshgrid(x1, x2)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fun_saddle(X1,X2)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax.contour(X1, X2, Y, <span class="dv">20</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>ax.clabel(CS, inline<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Saddle Point: $</span><span class="ch">\\</span><span class="st">eta = 80 + 4x_1 + 8x_2 - 2x_2^2 - 12x_1x_2$'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Text(0.5, 1.0, 'Saddle Point: $\\eta = 80 + 4x_1 + 8x_2 - 2x_2^2 - 12x_1x_2$')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="005_num_rsm_files/figure-html/cell-15-output-2.png" width="582" height="434" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-saddle-points" class="level3" data-number="5.3.8">
<h3 data-number="5.3.8" class="anchored" data-anchor-id="interpretation-saddle-points"><span class="header-section-number">5.3.8</span> Interpretation: Saddle Points</h3>
<ul>
<li>Likely further data collection, and/or outside expertise, is needed before determining a course of action in this situation</li>
</ul>
</section>
<section id="summary-ridge-analysis" class="level3" data-number="5.3.9">
<h3 data-number="5.3.9" class="anchored" data-anchor-id="summary-ridge-analysis"><span class="header-section-number">5.3.9</span> Summary: Ridge Analysis</h3>
<ul>
<li>Finding a simple maximum, or stationary ridge, represents ideals in the spectrum of second-order approximating functions</li>
<li>But getting there can be a bit of a slog</li>
<li>Using models fitted from data means uncertainty due to noise, and therefore uncertainty in the type of fitted second-order model</li>
<li>A ridge analysis attempts to offer a principled approach to navigating uncertainties when one is seeking local maxima</li>
<li>The two-dimensional setting exemplified above is convenient for visualization, but rare in practice</li>
<li>Complications compound when studying the effect of more than two process variables</li>
</ul>
</section>
</section>
<section id="general-rsm-models" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="general-rsm-models"><span class="header-section-number">5.4</span> General RSM Models</h2>
<ul>
<li>General <strong>first-order model</strong> on <span class="math inline">\(m\)</span> process variables <span class="math inline">\(x_1, x_2, \cdots, x_m\)</span> is <span class="math display">\[\eta = \beta_0 + \beta_1x_1 + \cdots + \beta_m x_m\]</span></li>
<li>General <strong>second-order model</strong> on <span class="math inline">\(m\)</span> process variables <span class="math display">\[
\eta= \beta_0 + \sum_{j=1}^m + \sum_{j=1}^m x_j^2 + \sum_{j=2}^m \sum_{k=1}^j \beta_{kj}x_k x_j.
\]</span></li>
</ul>
<section id="ordinary-least-squares" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="ordinary-least-squares"><span class="header-section-number">5.4.1</span> Ordinary Least Squares</h3>
<ul>
<li>Inference from data is carried out by <strong>ordinary least squares</strong> (OLS)</li>
<li>For an excellent review including R examples, see Sheather (2009)</li>
<li>OLS and maximum likelihood estimators (MLEs) are in the typical Gaussian linear modeling setup basically equivalent</li>
</ul>
</section>
</section>
<section id="designs" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="designs"><span class="header-section-number">5.5</span> Designs</h2>
<ul>
<li>Important: Organize the data collection phase of a response surface study carefully</li>
<li><strong>Design</strong>: choice of <span class="math inline">\(x\)</span>’s where we plan to observe <span class="math inline">\(y\)</span>’s, for the purpose of approximating <span class="math inline">\(f\)</span></li>
<li>Analyses and designs need to be carefully matched</li>
<li>When using a first-order model, some designs are preferred over others</li>
<li>When using a second-order model to capture curvature, a different sort of design is appropriate</li>
<li>Design choices often contain features enabling modeling assumptions to be challenged
<ul>
<li>e.g., to check if initial impressions are supported by the data ultimately collected</li>
</ul></li>
</ul>
<section id="different-designs" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="different-designs"><span class="header-section-number">5.5.1</span> Different Designs</h3>
<ul>
<li><strong>Screening desings</strong>: determine which variables matter so that subsequent experiments may be smaller and/or more focused</li>
<li>Then there are designs tailored to the form of model (first- or second-order, say) in the screened variables</li>
<li>And then there are more designs still</li>
</ul>
</section>
</section>
<section id="rsm-experimentation" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="rsm-experimentation"><span class="header-section-number">5.6</span> RSM Experimentation</h2>
<section id="first-step" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="first-step"><span class="header-section-number">5.6.1</span> First Step</h3>
<ul>
<li>RSM-based experimentation begins with a <strong>first-order model</strong>, possibly with interactions</li>
<li>Presumption: current process operating <strong>far from optimal</strong> conditions</li>
<li>Collect data and apply <strong>method of steepest ascent</strong> (gradient) on fitted surfaces to move to the optimum</li>
</ul>
</section>
<section id="second-step" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="second-step"><span class="header-section-number">5.6.2</span> Second Step</h3>
<ul>
<li>Eventually, if all goes well after several such carefully iterated refinements, <strong>second-order models</strong> are used on appropriate designs in order to zero-in on ideal operating conditions</li>
<li>Careful analysis of the fitted surface:
<ul>
<li>Ridge analysis with further refinement using gradients of, and</li>
<li>standard errors associated with, the fitted surfaces, and so on</li>
</ul></li>
</ul>
</section>
<section id="third-step" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="third-step"><span class="header-section-number">5.6.3</span> Third Step</h3>
<ul>
<li>Once the practitioner is satisfied with the full arc of
<ul>
<li>design(s),</li>
<li>fit(s), and</li>
<li>decision(s):</li>
</ul></li>
<li>A small experiment called <strong>confirmation test</strong> may be performed to check if the predicted optimal settings are realizable in practice</li>
</ul>
</section>
</section>
<section id="rsm-review-and-general-considerations" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="rsm-review-and-general-considerations"><span class="header-section-number">5.7</span> RSM: Review and General Considerations</h2>
<ul>
<li><p>First Glimpse, RSM seems sensible, and pretty straightforward as quantitative statistics-based analysis goes</p></li>
<li><p>But: RSM can get complicated, especially when input dimensions are not very low</p></li>
<li><p>Design considerations are particularly nuanced, since the goal is to obtain reliable estimates of main effects, interaction, and curvature while minimizing sampling effort/expense</p></li>
<li><p>RSM Downside: Inefficiency</p>
<ul>
<li>Despite intuitive appeal, several RSM downsides become apparent upon reflection</li>
<li>Problems in practice</li>
<li>Stepwise nature of sequential decision making is inefficient:
<ul>
<li>Not obvious how to re-use or update analysis from earlier phases, or couple with data from other sources/related experiments</li>
</ul></li>
</ul></li>
<li><p>RSM Downside: Locality</p>
<ul>
<li>In addition to being local in experiment-time (stepwise approach), it’s local in experiment-space</li>
<li>Balance between
<ul>
<li>exploration (maybe we’re barking up the wrong tree) and</li>
<li>exploitation (let’s make things a little better) is modest at best</li>
</ul></li>
</ul></li>
<li><p>RSM Downside: Expert Knowledge</p>
<ul>
<li>Interjection of expert knowledge is limited to hunches about relevant variables (i.e., the screening phase), where to initialize search, how to design the experiments</li>
<li>Yet at the same time classical RSMs rely heavily on constant examination throughout stages of modeling and design and on the instincts of seasoned practitioners</li>
</ul></li>
<li><p>RSM Downside: Replicability</p>
<ul>
<li>Parallel analyses, conducted according to the same best intentions, rarely lead to the same designs, model fits and so on</li>
<li>Sometimes that means they lead to different conclusions, which can be cause for concern</li>
</ul></li>
</ul>
<section id="historical-considerations-about-rsm" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="historical-considerations-about-rsm"><span class="header-section-number">5.7.1</span> Historical Considerations about RSM</h3>
<ul>
<li>In spite of those criticisms, however, there was historically little impetus to revise the status quo</li>
<li>Classical RSM was comfortable in its skin, consistently led to improvements or compelling evidence that none can reasonably be expected</li>
<li>But then in the late 20th century came an explosive expansion in computational capability, and with it a means of addressing many of those downsides</li>
</ul>
</section>
<section id="status-quo" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="status-quo"><span class="header-section-number">5.7.2</span> Status Quo</h3>
<ul>
<li>Nowadays, field experiments and statistical models, designs and optimizations are coupled with with mathematical models</li>
<li>Simple equations are not regarded as sufficient to describe real-world systems anymore</li>
<li>Physicists figured that out fifty years ago; industrial engineers followed, biologists, social scientists, climate scientists and weather forecasters, etc.</li>
<li>Systems of equations are required, solved over meshes (e.g., finite elements), or stochastically interacting agents</li>
<li>Goals for those simulation experiments are as diverse as their underlying dynamics</li>
<li>Optimization of systems is common, e.g., to identify worst-case scenarios</li>
</ul>
</section>
<section id="the-role-of-statistics" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="the-role-of-statistics"><span class="header-section-number">5.7.3</span> The Role of Statistics</h3>
<ul>
<li>Solving systems of equations, or interacting agents, requires computing</li>
<li>Statistics involved at various stages:
<ul>
<li>choosing the mathematical model</li>
<li>solving by stochastic simulation (Monte Carlo)</li>
<li>designing the computer experiment</li>
<li>smoothing over idiosyncrasies or noise</li>
<li>finding optimal conditions, or</li>
<li>calibrating mathematical/computer models to data from field experiments</li>
</ul></li>
</ul>
</section>
<section id="new-rsm-is-needed-dace" class="level3" data-number="5.7.4">
<h3 data-number="5.7.4" class="anchored" data-anchor-id="new-rsm-is-needed-dace"><span class="header-section-number">5.7.4</span> New RSM is needed: DACE</h3>
<ul>
<li>Classical RSMs are not well-suited to any of those tasks, because
<ul>
<li>they lack the fidelity required to model these data</li>
<li>their intended application is too local</li>
<li>they’re also too hands-on.</li>
</ul></li>
<li>Once computers are involved, a natural inclination is to automate—to remove humans from the loop and set the computer running on the analysis in order to maximize computing throughput, or minimize idle time</li>
<li><strong>Design and Analysis of Computer Experiments</strong> as a modern extension of RSM</li>
<li>Experimentation is changing due to advances in machine learning</li>
<li><strong>Gaussian process</strong> (GP) regression is the canonical surrogate model</li>
<li>Origins in geostatistics (gold mining)</li>
<li>Wide applicability in contexts where prediction is king</li>
<li>Machine learners exposed GPs as powerful predictors for all sorts of tasks:</li>
<li>from regression to classification,</li>
<li>active learning/sequential design,</li>
<li>reinforcement learning and optimization,</li>
<li>latent variable modeling, and so on</li>
</ul>
</section>
</section>
<section id="exercises" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="exercises"><span class="header-section-number">5.8</span> Exercises</h2>
<ol type="1">
<li>Generate 3d Plots for the Contour Plots in this notebook.</li>
<li>Write a <code>plot_3d</code> function, that takes the objective function <code>fun</code> as an argument.</li>
</ol>
<ul>
<li>It should provide the following interface: <code>plot_3d(fun)</code>.</li>
</ul>
<ol start="3" type="1">
<li>Write a <code>plot_contour</code> function, that takes the objective function <code>fun</code> as an argument:</li>
</ol>
<ul>
<li>It should provide the following interface: <code>plot_contour(fun)</code>.</li>
</ul>
<ol start="4" type="1">
<li>Consider further arguments that might be useful for both function, e.g., ranges, size, etc.</li>
</ol>
</section>
<section id="jupyter-notebook" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="jupyter-notebook"><span class="header-section-number">5.9</span> Jupyter Notebook</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The Jupyter-Notebook of this lecture is available on GitHub in the <a href="https://github.com/sequential-parameter-optimization/Hyperparameter-Tuning-Cookbook/blob/main/005_num_rsm.ipynb">Hyperparameter-Tuning-Cookbook Repository</a></li>
</ul>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./004_spot_sklearn_optimization.html" class="pagination-link  aria-label=" &lt;span="" parameter="" optimization:="" using="" `scipy`="" optimizers&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sequential Parameter Optimization: Using <code>scipy</code> Optimizers</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./006_num_gp.html" class="pagination-link" aria-label="<span class='chapter-number'>6</span>&nbsp; <span class='chapter-title'>Kriging (Gaussian Process Regression)</span>">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Kriging (Gaussian Process Regression)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>