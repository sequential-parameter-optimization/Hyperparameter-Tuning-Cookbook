spotPython.spot.spot 2024-01-07 23:03:04,322 INFO Starting the logger at level 10 for module spotPython.spot.spot:
spotPython.spot.spot 2024-01-07 23:03:04,322 DEBUG In Spot() init(): fun_control: {'CHECKPOINT_PATH': 'runs/saved_models/', 'DATASET_PATH': 'data/', 'RESULTS_PATH': 'results/', 'TENSORBOARD_PATH': 'runs/', '_L_in': 10, '_L_out': 1, 'accelerator': 'auto', 'counter': 0, 'data': None, 'data_dir': './data', 'data_module': None, 'data_set': <spotPython.data.diabetes.Diabetes object at 0x2d3ee9350>, 'design': None, 'device': 'mps', 'devices': 1, 'enable_progress_bar': False, 'eval': None, 'fun_evals': inf, 'fun_repeats': 1, 'infill_criterion': 'y', 'k_folds': 3, 'log_level': 10, 'loss_function': None, 'lower': array([3. , 4. , 1. , 0. , 0. , 0. , 0.1, 2. , 0. ]), 'max_time': 10, 'metric_river': None, 'metric_sklearn': None, 'metric_torch': None, 'metric_params': {}, 'model_dict': {}, 'noise': False, 'n_points': 1, 'n_samples': None, 'num_workers': 0, 'ocba_delta': 0, 'optimizer': None, 'path': None, 'prep_model': None, 'save_model': False, 'seed': 123, 'show_batch_interval': 1000000, 'show_models': False, 'show_progress': True, 'shuffle': None, 'sigma': 0.0, 'spot_tensorboard_path': 'runs/spot_logs/032_p040025_2024-01-07_23-03-04', 'spot_writer': <torch.utils.tensorboard.writer.SummaryWriter object at 0x2b77c6350>, 'target_column': None, 'test_seed': 1234, 'test_size': 0.1, 'tolerance_x': 1.4901161193847656e-08, 'train': None, 'test': None, 'task': None, 'upper': array([ 8.  ,  9.  ,  4.  ,  1.  , 11.  ,  0.25, 10.  ,  6.  ,  2.  ]), 'var_name': ['l1', 'epochs', 'batch_size', 'act_fn', 'optimizer', 'dropout_prob', 'lr_mult', 'patience', 'initialization'], 'var_type': ['int', 'int', 'int', 'factor', 'factor', 'float', 'float', 'int', 'factor'], 'weights': 1.0, 'core_model': <class 'spotPython.light.regression.rnnlightregression.RNNLightRegression'>, 'core_model_hyper_dict': {'l1': {'type': 'int', 'default': 3, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 5}, 'epochs': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 10, 'upper': 11}, 'batch_size': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 5}, 'act_fn': {'levels': ['ReLU'], 'type': 'factor', 'default': 'ReLU', 'transform': 'None', 'class_name': 'spotPython.torch.activation', 'core_model_parameter_type': 'instance()', 'lower': 0, 'upper': 0}, 'optimizer': {'levels': ['Adadelta'], 'type': 'factor', 'default': 'SGD', 'transform': 'None', 'class_name': 'torch.optim', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 0}, 'dropout_prob': {'type': 'float', 'default': 0.01, 'transform': 'None', 'lower': 0.01, 'upper': 0.2}, 'lr_mult': {'type': 'float', 'default': 1.0, 'transform': 'None', 'lower': 4.0, 'upper': 5.0}, 'patience': {'type': 'int', 'default': 2, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 7}, 'initialization': {'levels': ['Default', 'Kaiming', 'Xavier'], 'type': 'factor', 'default': 'Default', 'transform': 'None', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 2}}}
spotPython.spot.spot 2024-01-07 23:03:04,323 DEBUG In Spot() init(): design_control: {'init_size': 25, 'repeats': 1}
spotPython.spot.spot 2024-01-07 23:03:04,323 DEBUG In Spot() init(): optimizer_control: {'max_iter': 1000, 'seed': 125}
spotPython.spot.spot 2024-01-07 23:03:04,323 DEBUG In Spot() init(): surrogate_control: {'noise': True, 'model_optimizer': <function differential_evolution at 0x17ea08540>, 'model_fun_evals': 10000, 'min_theta': -3, 'max_theta': 3, 'n_theta': 5, 'n_p': 1, 'optim_p': False, 'seed': 124, 'theta_init_zero': True, 'var_type': ['int', 'float', 'float', 'int', 'factor']}
spotPython.spot.spot 2024-01-07 23:03:04,323 DEBUG In Spot() init(): self.get_spot_attributes_as_df():        Attribute Name                                    Attribute Value
0                   X                                               None
1           all_lower    [5.0, 10.0, 5.0, 0.0, 0.0, 0.01, 4.0, 5.0, 0.0]
2           all_upper     [5.0, 11.0, 5.0, 0.0, 0.0, 0.2, 5.0, 7.0, 2.0]
3        all_var_name  [l1, epochs, batch_size, act_fn, optimizer, dr...
4        all_var_type  [int, int, int, factor, factor, float, float, ...
5             counter                                                  0
6           de_bounds  [[10.0, 11.0], [0.01, 0.2], [4.0, 5.0], [5.0, ...
7              design  <spotPython.design.spacefilling.spacefilling o...
8      design_control                    {'init_size': 25, 'repeats': 1}
9                 eps                                                0.0
10        fun_control  {'CHECKPOINT_PATH': 'runs/saved_models/', 'DAT...
11          fun_evals                                                inf
12        fun_repeats                                                  1
13              ident  [True, False, True, True, True, False, False, ...
14   infill_criterion                                                  y
15                  k                                                  5
16          log_level                                                 10
17              lower                        [10.0, 0.01, 4.0, 5.0, 0.0]
18           max_time                                                 10
19             mean_X                                               None
20             mean_y                                               None
21              min_X                                               None
22         min_mean_X                                               None
23         min_mean_y                                               None
24              min_y                                               None
25           n_points                                                  1
26              noise                                              False
27         ocba_delta                                                  0
28  optimizer_control                    {'max_iter': 1000, 'seed': 125}
29            red_dim                                               True
30                rng                                   Generator(PCG64)
31        show_models                                              False
32      show_progress                                               True
33        spot_writer  <torch.utils.tensorboard.writer.SummaryWriter ...
34          surrogate  <spotPython.build.kriging.Kriging object at 0x...
35  surrogate_control  {'noise': True, 'model_optimizer': <function d...
36        tolerance_x                                                0.0
37              upper                         [11.0, 0.2, 5.0, 7.0, 2.0]
38           var_name  [epochs, dropout_prob, lr_mult, patience, init...
39           var_type                   [int, float, float, int, factor]
40              var_y                                               None
41                  y                                               None
spotPython.spot.spot 2024-01-07 23:03:04,341 DEBUG In Spot() initialize_design(), before calling self.fun: X_all: [[ 5.         10.          5.          0.          0.          0.16159096
   4.51118561  5.          1.        ]
 [ 5.         10.          5.          0.          0.          0.17778258
   4.70893702  7.          0.        ]
 [ 5.         11.          5.          0.          0.          0.03853827
   4.20703034  5.          1.        ]
 [ 5.         10.          5.          0.          0.          0.0485517
   4.27072367  6.          0.        ]
 [ 5.         11.          5.          0.          0.          0.02393913
   4.86008844  6.          1.        ]
 [ 5.         10.          5.          0.          0.          0.07481939
   4.53087027  7.          2.        ]
 [ 5.         11.          5.          0.          0.          0.08702835
   4.75127429  5.          1.        ]
 [ 5.         11.          5.          0.          0.          0.06474247
   4.04539113  6.          2.        ]
 [ 5.         11.          5.          0.          0.          0.19556739
   4.39048374  5.          1.        ]
 [ 5.         10.          5.          0.          0.          0.04788999
   4.95869792  6.          1.        ]
 [ 5.         10.          5.          0.          0.          0.09924252
   4.91987276  6.          1.        ]
 [ 5.         11.          5.          0.          0.          0.14045322
   4.61534035  6.          0.        ]
 [ 5.         11.          5.          0.          0.          0.10303304
   4.29735644  7.          0.        ]
 [ 5.         11.          5.          0.          0.          0.01403293
   4.01505766  5.          2.        ]
 [ 5.         10.          5.          0.          0.          0.08205472
   4.34365636  6.          1.        ]
 [ 5.         11.          5.          0.          0.          0.1725629
   4.45024484  6.          1.        ]
 [ 5.         10.          5.          0.          0.          0.05745076
   4.19689696  6.          1.        ]
 [ 5.         10.          5.          0.          0.          0.02557638
   4.42724502  6.          1.        ]
 [ 5.         11.          5.          0.          0.          0.14832879
   4.77378859  7.          2.        ]
 [ 5.         10.          5.          0.          0.          0.11524831
   4.64506908  7.          2.        ]
 [ 5.         11.          5.          0.          0.          0.16634107
   4.8056561   5.          2.        ]
 [ 5.         10.          5.          0.          0.          0.1321238
   4.98952796  5.          2.        ]
 [ 5.         11.          5.          0.          0.          0.19017182
   4.5902502   7.          1.        ]
 [ 5.         11.          5.          0.          0.          0.11934392
   4.09821138  6.          0.        ]
 [ 5.         10.          5.          0.          0.          0.12746953
   4.13282303  6.          0.        ]]
spotPython.spot.spot 2024-01-07 23:03:04,341 DEBUG In Spot() initialize_design(), before calling self.fun: fun_control: {'CHECKPOINT_PATH': 'runs/saved_models/', 'DATASET_PATH': 'data/', 'RESULTS_PATH': 'results/', 'TENSORBOARD_PATH': 'runs/', '_L_in': 10, '_L_out': 1, 'accelerator': 'auto', 'counter': 0, 'data': None, 'data_dir': './data', 'data_module': None, 'data_set': <spotPython.data.diabetes.Diabetes object at 0x2d3ee9350>, 'design': None, 'device': 'mps', 'devices': 1, 'enable_progress_bar': False, 'eval': None, 'fun_evals': inf, 'fun_repeats': 1, 'infill_criterion': 'y', 'k_folds': 3, 'log_level': 10, 'loss_function': None, 'lower': array([3. , 4. , 1. , 0. , 0. , 0. , 0.1, 2. , 0. ]), 'max_time': 10, 'metric_river': None, 'metric_sklearn': None, 'metric_torch': None, 'metric_params': {}, 'model_dict': {}, 'noise': False, 'n_points': 1, 'n_samples': None, 'num_workers': 0, 'ocba_delta': 0, 'optimizer': None, 'path': None, 'prep_model': None, 'save_model': False, 'seed': 123, 'show_batch_interval': 1000000, 'show_models': False, 'show_progress': True, 'shuffle': None, 'sigma': 0.0, 'spot_tensorboard_path': 'runs/spot_logs/032_p040025_2024-01-07_23-03-04', 'spot_writer': <torch.utils.tensorboard.writer.SummaryWriter object at 0x2b77c6350>, 'target_column': None, 'test_seed': 1234, 'test_size': 0.1, 'tolerance_x': 1.4901161193847656e-08, 'train': None, 'test': None, 'task': None, 'upper': array([ 8.  ,  9.  ,  4.  ,  1.  , 11.  ,  0.25, 10.  ,  6.  ,  2.  ]), 'var_name': ['l1', 'epochs', 'batch_size', 'act_fn', 'optimizer', 'dropout_prob', 'lr_mult', 'patience', 'initialization'], 'var_type': ['int', 'int', 'int', 'factor', 'factor', 'float', 'float', 'int', 'factor'], 'weights': 1.0, 'core_model': <class 'spotPython.light.regression.rnnlightregression.RNNLightRegression'>, 'core_model_hyper_dict': {'l1': {'type': 'int', 'default': 3, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 5}, 'epochs': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 10, 'upper': 11}, 'batch_size': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 5}, 'act_fn': {'levels': ['ReLU'], 'type': 'factor', 'default': 'ReLU', 'transform': 'None', 'class_name': 'spotPython.torch.activation', 'core_model_parameter_type': 'instance()', 'lower': 0, 'upper': 0}, 'optimizer': {'levels': ['Adadelta'], 'type': 'factor', 'default': 'SGD', 'transform': 'None', 'class_name': 'torch.optim', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 0}, 'dropout_prob': {'type': 'float', 'default': 0.01, 'transform': 'None', 'lower': 0.01, 'upper': 0.2}, 'lr_mult': {'type': 'float', 'default': 1.0, 'transform': 'None', 'lower': 4.0, 'upper': 5.0}, 'patience': {'type': 'int', 'default': 2, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 7}, 'initialization': {'levels': ['Default', 'Kaiming', 'Xavier'], 'type': 'factor', 'default': 'Default', 'transform': 'None', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 2}}}
spotPython.spot.spot 2024-01-07 23:07:49,342 DEBUG In Spot() initialize_design(), after calling self.fun: self.y: [          nan 3385.32641602           nan 4007.53686523           nan
           nan           nan           nan           nan           nan
           nan 3403.43359375 5741.46337891           nan           nan
           nan           nan           nan           nan           nan
           nan           nan           nan 3541.63012695 4058.1081543 ]
spotPython.spot.spot 2024-01-07 23:07:49,342 DEBUG New y value: [          nan 3385.32641602           nan 4007.53686523           nan
           nan           nan           nan           nan           nan
           nan 3403.43359375 5741.46337891           nan           nan
           nan           nan           nan           nan           nan
           nan           nan           nan 3541.63012695 4058.1081543 ]
spotPython.spot.spot 2024-01-07 23:07:49,352 DEBUG In Spot() initialize_design(), final X val, after remove nan: self.X: [[10.          0.17778258  4.70893702  7.          0.        ]
 [10.          0.0485517   4.27072367  6.          0.        ]
 [11.          0.14045322  4.61534035  6.          0.        ]
 [11.          0.10303304  4.29735644  7.          0.        ]
 [11.          0.11934392  4.09821138  6.          0.        ]
 [10.          0.12746953  4.13282303  6.          0.        ]]
spotPython.spot.spot 2024-01-07 23:07:49,352 DEBUG In Spot() initialize_design(), final y val, after remove nan: self.y: [3385.32641602 4007.53686523 3403.43359375 5741.46337891 3541.63012695
 4058.1081543 ]
spotPython.spot.spot 2024-01-07 23:07:49,352 DEBUG In fit_surrogate(): self.X: [[10.          0.17778258  4.70893702  7.          0.        ]
 [10.          0.0485517   4.27072367  6.          0.        ]
 [11.          0.14045322  4.61534035  6.          0.        ]
 [11.          0.10303304  4.29735644  7.          0.        ]
 [11.          0.11934392  4.09821138  6.          0.        ]
 [10.          0.12746953  4.13282303  6.          0.        ]]
spotPython.spot.spot 2024-01-07 23:07:49,352 DEBUG In fit_surrogate(): self.y: [3385.32641602 4007.53686523 3403.43359375 5741.46337891 3541.63012695
 4058.1081543 ]
spotPython.spot.spot 2024-01-07 23:07:49,352 DEBUG In fit_surrogate(): self.X.shape: (6, 5)
spotPython.spot.spot 2024-01-07 23:07:49,352 DEBUG In fit_surrogate(): self.y.shape: (6,)
spotPython.spot.spot 2024-01-07 23:07:49,538 DEBUG XO values are new: [ True] [[11.   0.2  5.   6.   0. ]]
spotPython.spot.spot 2024-01-07 23:07:49,538 DEBUG In update_design(): self.fun_control sigma and seed passed to fun(): 0.0 123
spotPython.spot.spot 2024-01-07 23:08:47,816 DEBUG In fit_surrogate(): self.X: [[10.          0.17778258  4.70893702  7.          0.        ]
 [10.          0.0485517   4.27072367  6.          0.        ]
 [11.          0.14045322  4.61534035  6.          0.        ]
 [11.          0.10303304  4.29735644  7.          0.        ]
 [11.          0.11934392  4.09821138  6.          0.        ]
 [10.          0.12746953  4.13282303  6.          0.        ]
 [11.          0.2         5.          6.          0.        ]]
spotPython.spot.spot 2024-01-07 23:08:47,816 DEBUG In fit_surrogate(): self.y: [3385.32641602 4007.53686523 3403.43359375 5741.46337891 3541.63012695
 4058.1081543  4647.06738281]
spotPython.spot.spot 2024-01-07 23:08:47,816 DEBUG In fit_surrogate(): self.X.shape: (7, 5)
spotPython.spot.spot 2024-01-07 23:08:47,816 DEBUG In fit_surrogate(): self.y.shape: (7,)
spotPython.spot.spot 2024-01-07 23:08:47,990 DEBUG XO values are new: [ True] [[10.          0.18601081  4.7537892   7.          0.        ]]
spotPython.spot.spot 2024-01-07 23:08:47,990 DEBUG In update_design(): self.fun_control sigma and seed passed to fun(): 0.0 123
spotPython.spot.spot 2024-01-07 23:09:50,206 DEBUG In fit_surrogate(): self.X: [[10.          0.17778258  4.70893702  7.          0.        ]
 [10.          0.0485517   4.27072367  6.          0.        ]
 [11.          0.14045322  4.61534035  6.          0.        ]
 [11.          0.10303304  4.29735644  7.          0.        ]
 [11.          0.11934392  4.09821138  6.          0.        ]
 [10.          0.12746953  4.13282303  6.          0.        ]
 [11.          0.2         5.          6.          0.        ]
 [10.          0.18601081  4.7537892   7.          0.        ]]
spotPython.spot.spot 2024-01-07 23:09:50,206 DEBUG In fit_surrogate(): self.y: [3385.32641602 4007.53686523 3403.43359375 5741.46337891 3541.63012695
 4058.1081543  4647.06738281 5442.01464844]
spotPython.spot.spot 2024-01-07 23:09:50,206 DEBUG In fit_surrogate(): self.X.shape: (8, 5)
spotPython.spot.spot 2024-01-07 23:09:50,206 DEBUG In fit_surrogate(): self.y.shape: (8,)
spotPython.spot.spot 2024-01-07 23:09:50,261 DEBUG XO values are new: [ True] [[10.          0.17688756  4.70405837  7.          0.        ]]
spotPython.spot.spot 2024-01-07 23:09:50,262 DEBUG In update_design(): self.fun_control sigma and seed passed to fun(): 0.0 123
