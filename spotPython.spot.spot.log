spotPython.spot.spot 2024-01-05 13:16:44,800 INFO Starting the logger at level 10 for module spotPython.spot.spot:
spotPython.spot.spot 2024-01-05 13:16:44,800 DEBUG In Spot() init(): fun_control: {'CHECKPOINT_PATH': 'runs/saved_models/', 'DATASET_PATH': 'data/', 'RESULTS_PATH': 'results/', 'TENSORBOARD_PATH': 'runs/', '_L_in': 133, '_L_out': 1, 'data': None, 'data_dir': './data', 'data_module': None, 'data_set': <spotPython.data.pkldataset.PKLDataset object at 0x2dab1ec10>, 'device': 'mps', 'enable_progress_bar': False, 'eval': None, 'fun_evals': 100, 'k_folds': 3, 'log_level': 10, 'loss_function': None, 'max_time': 1, 'metric_river': None, 'metric_sklearn': None, 'metric_torch': None, 'metric_params': {}, 'model_dict': {}, 'n_samples': None, 'num_workers': 0, 'optimizer': None, 'path': None, 'prep_model': None, 'save_model': False, 'seed': 1234, 'show_batch_interval': 1000000, 'show_progress': True, 'shuffle': None, 'sigma': 0.0, 'target_column': None, 'tolerance_x': 1.4901161193847656e-08, 'train': None, 'test': None, 'task': 'classification', 'spot_tensorboard_path': 'runs/spot_logs/031_bartz09_2024-01-05_13-16-44', 'var_name': ['l1', 'epochs', 'batch_size', 'act_fn', 'optimizer', 'dropout_prob', 'lr_mult', 'patience', 'initialization'], 'var_type': ['int', 'int', 'int', 'factor', 'factor', 'float', 'float', 'int', 'factor'], 'weights': 1.0, 'spot_writer': <torch.utils.tensorboard.writer.SummaryWriter object at 0x2d80d60d0>, 'core_model': <class 'spotPython.light.regression.netlightregression.NetLightRegression'>, 'core_model_hyper_dict': {'l1': {'type': 'int', 'default': 3, 'transform': 'transform_power_2_int', 'lower': 3, 'upper': 8}, 'epochs': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 4, 'upper': 9}, 'batch_size': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 1, 'upper': 4}, 'act_fn': {'levels': ['Sigmoid', 'Tanh', 'ReLU', 'LeakyReLU', 'ELU', 'Swish'], 'type': 'factor', 'default': 'ReLU', 'transform': 'None', 'class_name': 'spotPython.torch.activation', 'core_model_parameter_type': 'instance()', 'lower': 0, 'upper': 5}, 'optimizer': {'levels': ['Adam', 'AdamW', 'Adamax', 'NAdam'], 'type': 'factor', 'default': 'SGD', 'transform': 'None', 'class_name': 'torch.optim', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 3}, 'dropout_prob': {'type': 'float', 'default': 0.01, 'transform': 'None', 'lower': 0.0, 'upper': 0.25}, 'lr_mult': {'type': 'float', 'default': 1.0, 'transform': 'None', 'lower': 0.1, 'upper': 10.0}, 'patience': {'type': 'int', 'default': 2, 'transform': 'transform_power_2_int', 'lower': 2, 'upper': 6}, 'initialization': {'levels': ['Default', 'Kaiming', 'Xavier'], 'type': 'factor', 'default': 'Default', 'transform': 'None', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 2}}}
spotPython.spot.spot 2024-01-05 13:16:44,800 DEBUG In Spot() init(): optimizer_control: {'max_iter': 1000, 'seed': 125}
spotPython.spot.spot 2024-01-05 13:16:44,800 DEBUG In Spot() init(): surrogate_control: {'noise': True, 'model_optimizer': <function differential_evolution at 0x2dc12f420>, 'model_fun_evals': 10000, 'min_theta': -4, 'max_theta': 3, 'n_theta': 2, 'theta_init_zero': True, 'n_p': 1, 'optim_p': False, 'var_type': ['int', 'int', 'int', 'factor', 'factor', 'float', 'float', 'int', 'factor'], 'seed': 124, 'log_level': 10}
spotPython.spot.spot 2024-01-05 13:16:44,801 DEBUG In Spot() init(): self.get_spot_attributes_as_df():        Attribute Name                                    Attribute Value
0                   X                                               None
1           all_lower      [3.0, 4.0, 1.0, 0.0, 0.0, 0.0, 0.1, 2.0, 0.0]
2           all_upper    [8.0, 9.0, 4.0, 5.0, 3.0, 0.25, 10.0, 6.0, 2.0]
3        all_var_name  [l1, epochs, batch_size, act_fn, optimizer, dr...
4        all_var_type  [int, int, int, factor, factor, float, float, ...
5             counter                                                  0
6           de_bounds  [[3.0, 8.0], [4.0, 9.0], [1.0, 4.0], [0.0, 5.0...
7              design  <spotPython.design.spacefilling.spacefilling o...
8      design_control                     {'init_size': 5, 'repeats': 1}
9                 eps                                                0.0
10        fun_control  {'CHECKPOINT_PATH': 'runs/saved_models/', 'DAT...
11          fun_evals                                                100
12        fun_repeats                                                  1
13              ident  [False, False, False, False, False, False, Fal...
14   infill_criterion                                                  y
15                  k                                                  9
16          log_level                                                 10
17              lower      [3.0, 4.0, 1.0, 0.0, 0.0, 0.0, 0.1, 2.0, 0.0]
18           max_time                                                  1
19             mean_X                                               None
20             mean_y                                               None
21              min_X                                               None
22         min_mean_X                                               None
23         min_mean_y                                               None
24              min_y                                               None
25           n_points                                                  1
26              noise                                              False
27         ocba_delta                                                  0
28  optimizer_control                    {'max_iter': 1000, 'seed': 125}
29            red_dim                                              False
30                rng                                   Generator(PCG64)
31        show_models                                              False
32      show_progress                                               True
33        spot_writer  <torch.utils.tensorboard.writer.SummaryWriter ...
34          surrogate  <spotPython.build.kriging.Kriging object at 0x...
35  surrogate_control  {'noise': True, 'model_optimizer': <function d...
36        tolerance_x                                                0.0
37              upper    [8.0, 9.0, 4.0, 5.0, 3.0, 0.25, 10.0, 6.0, 2.0]
38           var_name  [l1, epochs, batch_size, act_fn, optimizer, dr...
39           var_type  [int, int, int, factor, factor, float, float, ...
40              var_y                                               None
41                  y                                               None
spotPython.spot.spot 2024-01-05 13:16:44,870 DEBUG In Spot() initialize_design(), before calling self.fun: X_all: [[6.         5.         2.         4.         0.         0.19409544
  5.56130274 4.         1.        ]
 [6.         6.         4.         4.         1.         0.01625593
  6.71344879 5.         1.        ]
 [8.         8.         3.         1.         3.         0.1194491
  3.94092812 2.         0.        ]
 [4.         7.         3.         0.         1.         0.06320905
  0.25435443 6.         2.        ]
 [4.         7.         2.         3.         2.         0.23594739
  8.27919881 3.         1.        ]]
spotPython.spot.spot 2024-01-05 13:16:44,870 DEBUG In Spot() initialize_design(), before calling self.fun: fun_control: {'CHECKPOINT_PATH': 'runs/saved_models/', 'DATASET_PATH': 'data/', 'RESULTS_PATH': 'results/', 'TENSORBOARD_PATH': 'runs/', '_L_in': 133, '_L_out': 1, 'data': None, 'data_dir': './data', 'data_module': None, 'data_set': <spotPython.data.pkldataset.PKLDataset object at 0x2dab1ec10>, 'device': 'mps', 'enable_progress_bar': False, 'eval': None, 'fun_evals': 100, 'k_folds': 3, 'log_level': 10, 'loss_function': None, 'max_time': 1, 'metric_river': None, 'metric_sklearn': None, 'metric_torch': None, 'metric_params': {}, 'model_dict': {}, 'n_samples': None, 'num_workers': 0, 'optimizer': None, 'path': None, 'prep_model': None, 'save_model': False, 'seed': 1234, 'show_batch_interval': 1000000, 'show_progress': True, 'shuffle': None, 'sigma': 0.0, 'target_column': None, 'tolerance_x': 1.4901161193847656e-08, 'train': None, 'test': None, 'task': 'classification', 'spot_tensorboard_path': 'runs/spot_logs/031_bartz09_2024-01-05_13-16-44', 'var_name': ['l1', 'epochs', 'batch_size', 'act_fn', 'optimizer', 'dropout_prob', 'lr_mult', 'patience', 'initialization'], 'var_type': ['int', 'int', 'int', 'factor', 'factor', 'float', 'float', 'int', 'factor'], 'weights': 1.0, 'spot_writer': <torch.utils.tensorboard.writer.SummaryWriter object at 0x2d80d60d0>, 'core_model': <class 'spotPython.light.regression.netlightregression.NetLightRegression'>, 'core_model_hyper_dict': {'l1': {'type': 'int', 'default': 3, 'transform': 'transform_power_2_int', 'lower': 3, 'upper': 8}, 'epochs': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 4, 'upper': 9}, 'batch_size': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 1, 'upper': 4}, 'act_fn': {'levels': ['Sigmoid', 'Tanh', 'ReLU', 'LeakyReLU', 'ELU', 'Swish'], 'type': 'factor', 'default': 'ReLU', 'transform': 'None', 'class_name': 'spotPython.torch.activation', 'core_model_parameter_type': 'instance()', 'lower': 0, 'upper': 5}, 'optimizer': {'levels': ['Adam', 'AdamW', 'Adamax', 'NAdam'], 'type': 'factor', 'default': 'SGD', 'transform': 'None', 'class_name': 'torch.optim', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 3}, 'dropout_prob': {'type': 'float', 'default': 0.01, 'transform': 'None', 'lower': 0.0, 'upper': 0.25}, 'lr_mult': {'type': 'float', 'default': 1.0, 'transform': 'None', 'lower': 0.1, 'upper': 10.0}, 'patience': {'type': 'int', 'default': 2, 'transform': 'transform_power_2_int', 'lower': 2, 'upper': 6}, 'initialization': {'levels': ['Default', 'Kaiming', 'Xavier'], 'type': 'factor', 'default': 'Default', 'transform': 'None', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 2}}}
spotPython.spot.spot 2024-01-05 13:17:14,129 DEBUG In Spot() initialize_design(), after calling self.fun: self.y: [        nan         nan         nan         nan 230607.9375]
spotPython.spot.spot 2024-01-05 13:17:14,129 DEBUG New y value: [        nan         nan         nan         nan 230607.9375]
spotPython.spot.spot 2024-01-05 13:17:14,132 DEBUG In Spot() initialize_design(), final X val, after remove nan: self.X: [[4.         7.         2.         3.         2.         0.23594739
  8.27919881 3.         1.        ]]
spotPython.spot.spot 2024-01-05 13:17:14,132 DEBUG In Spot() initialize_design(), final y val, after remove nan: self.y: [230607.9375]
spotPython.spot.spot 2024-01-05 13:17:14,132 DEBUG In fit_surrogate(): self.X: [[4.         7.         2.         3.         2.         0.23594739
  8.27919881 3.         1.        ]]
spotPython.spot.spot 2024-01-05 13:17:14,132 DEBUG In fit_surrogate(): self.y: [230607.9375]
spotPython.spot.spot 2024-01-05 13:17:14,132 DEBUG In fit_surrogate(): self.X.shape: (1, 9)
spotPython.spot.spot 2024-01-05 13:17:14,132 DEBUG In fit_surrogate(): self.y.shape: (1,)
