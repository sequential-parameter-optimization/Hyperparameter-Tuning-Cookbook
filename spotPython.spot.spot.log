spotPython.spot.spot 2024-01-08 10:38:56,353 INFO Starting the logger at level 10 for module spotPython.spot.spot:
spotPython.spot.spot 2024-01-08 10:38:56,353 DEBUG In Spot() init(): fun_control: {'CHECKPOINT_PATH': 'runs/saved_models/', 'DATASET_PATH': 'data/', 'RESULTS_PATH': 'results/', 'TENSORBOARD_PATH': 'runs/', '_L_in': 10, '_L_out': 1, 'accelerator': 'auto', 'counter': 0, 'data': None, 'data_dir': './data', 'data_module': None, 'data_set': <spotPython.data.diabetes.Diabetes object at 0x2b3313d90>, 'design': None, 'device': 'mps', 'devices': 1, 'enable_progress_bar': False, 'eval': None, 'fun_evals': inf, 'fun_repeats': 1, 'infill_criterion': 'y', 'k_folds': 3, 'log_level': 10, 'loss_function': None, 'lower': array([3. , 4. , 1. , 0. , 0. , 0. , 0.1, 2. , 0. ]), 'max_time': 30, 'metric_river': None, 'metric_sklearn': None, 'metric_torch': None, 'metric_params': {}, 'model_dict': {}, 'noise': False, 'n_points': 1, 'n_samples': None, 'num_workers': 0, 'ocba_delta': 0, 'optimizer': None, 'path': None, 'prep_model': None, 'save_model': False, 'seed': 123, 'show_batch_interval': 1000000, 'show_models': False, 'show_progress': True, 'shuffle': None, 'sigma': 0.0, 'spot_tensorboard_path': 'runs/spot_logs/032_p040025_2024-01-08_10-38-56', 'spot_writer': <torch.utils.tensorboard.writer.SummaryWriter object at 0x2b8473fd0>, 'target_column': None, 'test_seed': 1234, 'test_size': 0.1, 'tolerance_x': 1.4901161193847656e-08, 'train': None, 'test': None, 'task': None, 'upper': array([ 8.  ,  9.  ,  4.  ,  1.  , 11.  ,  0.25, 10.  ,  6.  ,  2.  ]), 'var_name': ['l1', 'epochs', 'batch_size', 'act_fn', 'optimizer', 'dropout_prob', 'lr_mult', 'patience', 'initialization'], 'var_type': ['int', 'int', 'int', 'factor', 'factor', 'float', 'float', 'int', 'factor'], 'weights': 1.0, 'core_model': <class 'userrnn.RNNLightRegression'>, 'core_model_hyper_dict': {'l1': {'type': 'int', 'default': 3, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 7}, 'epochs': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 10, 'upper': 13}, 'batch_size': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 2, 'upper': 6}, 'act_fn': {'levels': ['ReLU'], 'type': 'factor', 'default': 'ReLU', 'transform': 'None', 'class_name': 'spotPython.torch.activation', 'core_model_parameter_type': 'instance()', 'lower': 0, 'upper': 0}, 'optimizer': {'levels': ['Adadelta', 'Adagrad', 'Adam', 'AdamW', 'Adamax'], 'type': 'factor', 'default': 'SGD', 'transform': 'None', 'class_name': 'torch.optim', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 4}, 'dropout_prob': {'type': 'float', 'default': 0.01, 'transform': 'None', 'lower': 0.01, 'upper': 0.25}, 'lr_mult': {'type': 'float', 'default': 1.0, 'transform': 'None', 'lower': 0.5, 'upper': 5.0}, 'patience': {'type': 'int', 'default': 2, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 8}, 'initialization': {'levels': ['Default', 'Kaiming', 'Xavier'], 'type': 'factor', 'default': 'Default', 'transform': 'None', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 2}}}
spotPython.spot.spot 2024-01-08 10:38:56,353 DEBUG In Spot() init(): design_control: {'init_size': 50, 'repeats': 1}
spotPython.spot.spot 2024-01-08 10:38:56,353 DEBUG In Spot() init(): optimizer_control: {'max_iter': 1000, 'seed': 125}
spotPython.spot.spot 2024-01-08 10:38:56,353 DEBUG In Spot() init(): surrogate_control: {'noise': True, 'model_optimizer': <function differential_evolution at 0x173a34540>, 'model_fun_evals': 10000, 'min_theta': -3, 'max_theta': 3, 'n_theta': 8, 'n_p': 1, 'optim_p': False, 'seed': 124, 'theta_init_zero': True, 'var_type': ['int', 'int', 'int', 'factor', 'float', 'float', 'int', 'factor']}
spotPython.spot.spot 2024-01-08 10:38:56,353 DEBUG In Spot() init(): self.get_spot_attributes_as_df():        Attribute Name                                    Attribute Value
0                   X                                               None
1           all_lower    [5.0, 10.0, 2.0, 0.0, 0.0, 0.01, 0.5, 5.0, 0.0]
2           all_upper    [7.0, 13.0, 6.0, 0.0, 4.0, 0.25, 5.0, 8.0, 2.0]
3        all_var_name  [l1, epochs, batch_size, act_fn, optimizer, dr...
4        all_var_type  [int, int, int, factor, factor, float, float, ...
5             counter                                                  0
6           de_bounds  [[5.0, 7.0], [10.0, 13.0], [2.0, 6.0], [0.0, 4...
7              design  <spotPython.design.spacefilling.spacefilling o...
8      design_control                    {'init_size': 50, 'repeats': 1}
9                 eps                                                0.0
10        fun_control  {'CHECKPOINT_PATH': 'runs/saved_models/', 'DAT...
11          fun_evals                                                inf
12        fun_repeats                                                  1
13              ident  [False, False, False, True, False, False, Fals...
14   infill_criterion                                                  y
15                  k                                                  8
16          log_level                                                 10
17              lower         [5.0, 10.0, 2.0, 0.0, 0.01, 0.5, 5.0, 0.0]
18           max_time                                                 30
19             mean_X                                               None
20             mean_y                                               None
21              min_X                                               None
22         min_mean_X                                               None
23         min_mean_y                                               None
24              min_y                                               None
25           n_points                                                  1
26              noise                                              False
27         ocba_delta                                                  0
28  optimizer_control                    {'max_iter': 1000, 'seed': 125}
29            red_dim                                               True
30                rng                                   Generator(PCG64)
31        show_models                                              False
32      show_progress                                               True
33        spot_writer  <torch.utils.tensorboard.writer.SummaryWriter ...
34          surrogate  <spotPython.build.kriging.Kriging object at 0x...
35  surrogate_control  {'noise': True, 'model_optimizer': <function d...
36        tolerance_x                                                0.0
37              upper         [7.0, 13.0, 6.0, 4.0, 0.25, 5.0, 8.0, 2.0]
38           var_name  [l1, epochs, batch_size, optimizer, dropout_pr...
39           var_type  [int, int, int, factor, float, float, int, fac...
40              var_y                                               None
41                  y                                               None
spotPython.spot.spot 2024-01-08 10:38:56,372 DEBUG In Spot() initialize_design(), before calling self.fun: X_all: [[6.00000000e+00 1.20000000e+01 6.00000000e+00 0.00000000e+00
  3.00000000e+00 7.15556517e-02 6.06911494e-01 5.00000000e+00
  1.00000000e+00]
 [5.00000000e+00 1.20000000e+01 5.00000000e+00 0.00000000e+00
  1.00000000e+00 1.45243640e-01 3.63076133e+00 8.00000000e+00
  1.00000000e+00]
 [7.00000000e+00 1.20000000e+01 3.00000000e+00 0.00000000e+00
  1.00000000e+00 1.62488533e-01 3.99506864e+00 8.00000000e+00
  1.00000000e+00]
 [5.00000000e+00 1.10000000e+01 3.00000000e+00 0.00000000e+00
  2.00000000e+00 8.71907176e-02 1.34370194e+00 8.00000000e+00
  0.00000000e+00]
 [5.00000000e+00 1.30000000e+01 4.00000000e+00 0.00000000e+00
  3.00000000e+00 7.33741909e-02 1.05213005e+00 6.00000000e+00
  2.00000000e+00]
 [6.00000000e+00 1.20000000e+01 3.00000000e+00 0.00000000e+00
  1.00000000e+00 1.53166568e-01 2.27185320e+00 6.00000000e+00
  2.00000000e+00]
 [6.00000000e+00 1.30000000e+01 3.00000000e+00 0.00000000e+00
  4.00000000e+00 2.49984731e-01 4.51570390e+00 7.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.30000000e+01 4.00000000e+00 0.00000000e+00
  3.00000000e+00 2.18802464e-01 3.40170707e+00 8.00000000e+00
  2.00000000e+00]
 [6.00000000e+00 1.20000000e+01 6.00000000e+00 0.00000000e+00
  1.00000000e+00 1.01458656e-01 2.35082065e+00 7.00000000e+00
  0.00000000e+00]
 [7.00000000e+00 1.00000000e+01 2.00000000e+00 0.00000000e+00
  1.00000000e+00 2.13471305e-01 1.96305088e+00 7.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.10000000e+01 2.00000000e+00 0.00000000e+00
  0.00000000e+00 1.86139067e-01 2.76432601e+00 7.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.20000000e+01 4.00000000e+00 0.00000000e+00
  3.00000000e+00 9.32546312e-02 1.28941669e+00 6.00000000e+00
  0.00000000e+00]
 [7.00000000e+00 1.30000000e+01 6.00000000e+00 0.00000000e+00
  4.00000000e+00 1.08115602e-01 3.34140744e+00 6.00000000e+00
  0.00000000e+00]
 [6.00000000e+00 1.10000000e+01 4.00000000e+00 0.00000000e+00
  1.00000000e+00 1.79497128e-01 4.44658526e+00 5.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.00000000e+01 6.00000000e+00 0.00000000e+00
  2.00000000e+00 1.94259320e-01 4.59097561e+00 7.00000000e+00
  2.00000000e+00]
 [5.00000000e+00 1.00000000e+01 5.00000000e+00 0.00000000e+00
  1.00000000e+00 1.38868971e-01 9.36947799e-01 5.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.20000000e+01 6.00000000e+00 0.00000000e+00
  3.00000000e+00 1.76901979e-01 8.40342359e-01 8.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.20000000e+01 5.00000000e+00 0.00000000e+00
  2.00000000e+00 1.20796844e-01 1.03276511e+00 8.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.00000000e+01 5.00000000e+00 0.00000000e+00
  2.00000000e+00 2.40215278e-01 7.41622527e-01 6.00000000e+00
  1.00000000e+00]
 [7.00000000e+00 1.00000000e+01 3.00000000e+00 0.00000000e+00
  0.00000000e+00 4.61625340e-02 5.71360140e-01 6.00000000e+00
  2.00000000e+00]
 [7.00000000e+00 1.10000000e+01 4.00000000e+00 0.00000000e+00
  3.00000000e+00 8.62332319e-02 3.04164949e+00 6.00000000e+00
  0.00000000e+00]
 [6.00000000e+00 1.20000000e+01 2.00000000e+00 0.00000000e+00
  3.00000000e+00 9.90026276e-02 2.71455529e+00 6.00000000e+00
  0.00000000e+00]
 [5.00000000e+00 1.30000000e+01 3.00000000e+00 0.00000000e+00
  0.00000000e+00 1.21557854e-02 1.83028887e+00 7.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.00000000e+01 2.00000000e+00 0.00000000e+00
  2.00000000e+00 1.48559543e-02 1.54394980e+00 8.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.10000000e+01 2.00000000e+00 0.00000000e+00
  1.00000000e+00 1.29684934e-01 3.82281674e+00 7.00000000e+00
  2.00000000e+00]
 [7.00000000e+00 1.10000000e+01 3.00000000e+00 0.00000000e+00
  1.00000000e+00 2.24513507e-01 3.72406902e+00 7.00000000e+00
  1.00000000e+00]
 [5.00000000e+00 1.00000000e+01 4.00000000e+00 0.00000000e+00
  3.00000000e+00 1.13845894e-01 4.30815439e+00 7.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.10000000e+01 6.00000000e+00 0.00000000e+00
  1.00000000e+00 8.00351963e-02 3.55750565e+00 7.00000000e+00
  1.00000000e+00]
 [5.00000000e+00 1.10000000e+01 6.00000000e+00 0.00000000e+00
  4.00000000e+00 2.00360742e-01 1.63346486e+00 5.00000000e+00
  1.00000000e+00]
 [7.00000000e+00 1.10000000e+01 4.00000000e+00 0.00000000e+00
  4.00000000e+00 1.34282649e-01 3.86944927e+00 7.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.20000000e+01 3.00000000e+00 0.00000000e+00
  3.00000000e+00 1.72464020e-01 2.06772064e+00 6.00000000e+00
  2.00000000e+00]
 [5.00000000e+00 1.10000000e+01 3.00000000e+00 0.00000000e+00
  1.00000000e+00 2.04452686e-01 4.20568452e+00 7.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.20000000e+01 5.00000000e+00 0.00000000e+00
  3.00000000e+00 6.30237892e-02 2.91111413e+00 5.00000000e+00
  2.00000000e+00]
 [6.00000000e+00 1.20000000e+01 3.00000000e+00 0.00000000e+00
  2.00000000e+00 5.37328718e-02 4.70900021e+00 6.00000000e+00
  0.00000000e+00]
 [7.00000000e+00 1.10000000e+01 3.00000000e+00 0.00000000e+00
  3.00000000e+00 2.78837929e-02 2.46841486e+00 5.00000000e+00
  2.00000000e+00]
 [5.00000000e+00 1.20000000e+01 5.00000000e+00 0.00000000e+00
  2.00000000e+00 1.91922950e-01 1.47367855e+00 6.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.30000000e+01 4.00000000e+00 0.00000000e+00
  2.00000000e+00 2.27863995e-01 3.22864504e+00 5.00000000e+00
  0.00000000e+00]
 [6.00000000e+00 1.00000000e+01 2.00000000e+00 0.00000000e+00
  0.00000000e+00 5.18738874e-02 2.61017199e+00 7.00000000e+00
  2.00000000e+00]
 [5.00000000e+00 1.10000000e+01 5.00000000e+00 0.00000000e+00
  2.00000000e+00 1.19663621e-01 2.50515844e+00 7.00000000e+00
  1.00000000e+00]
 [7.00000000e+00 1.30000000e+01 4.00000000e+00 0.00000000e+00
  1.00000000e+00 3.89073524e-02 4.82641817e+00 7.00000000e+00
  2.00000000e+00]
 [5.00000000e+00 1.20000000e+01 5.00000000e+00 0.00000000e+00
  2.00000000e+00 1.54201755e-01 4.05407757e+00 5.00000000e+00
  1.00000000e+00]
 [7.00000000e+00 1.10000000e+01 5.00000000e+00 0.00000000e+00
  2.00000000e+00 3.80164577e-02 2.95597107e+00 7.00000000e+00
  0.00000000e+00]
 [6.00000000e+00 1.10000000e+01 3.00000000e+00 0.00000000e+00
  2.00000000e+00 2.43800255e-01 2.12183504e+00 6.00000000e+00
  2.00000000e+00]
 [7.00000000e+00 1.00000000e+01 4.00000000e+00 0.00000000e+00
  1.00000000e+00 6.25511673e-02 1.89994882e+00 6.00000000e+00
  0.00000000e+00]
 [7.00000000e+00 1.20000000e+01 5.00000000e+00 0.00000000e+00
  4.00000000e+00 2.20464712e-02 1.19802660e+00 6.00000000e+00
  0.00000000e+00]
 [7.00000000e+00 1.20000000e+01 4.00000000e+00 0.00000000e+00
  0.00000000e+00 1.40964019e-01 4.18319286e+00 6.00000000e+00
  1.00000000e+00]
 [5.00000000e+00 1.30000000e+01 3.00000000e+00 0.00000000e+00
  2.00000000e+00 3.32447277e-02 3.13436409e+00 6.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.20000000e+01 5.00000000e+00 0.00000000e+00
  3.00000000e+00 2.32503269e-01 1.72336305e+00 6.00000000e+00
  0.00000000e+00]
 [5.00000000e+00 1.10000000e+01 5.00000000e+00 0.00000000e+00
  0.00000000e+00 1.63994768e-01 4.92913596e+00 8.00000000e+00
  1.00000000e+00]
 [6.00000000e+00 1.10000000e+01 4.00000000e+00 0.00000000e+00
  4.00000000e+00 2.09060982e-01 4.74963771e+00 7.00000000e+00
  2.00000000e+00]]
spotPython.spot.spot 2024-01-08 10:38:56,373 DEBUG In Spot() initialize_design(), before calling self.fun: fun_control: {'CHECKPOINT_PATH': 'runs/saved_models/', 'DATASET_PATH': 'data/', 'RESULTS_PATH': 'results/', 'TENSORBOARD_PATH': 'runs/', '_L_in': 10, '_L_out': 1, 'accelerator': 'auto', 'counter': 0, 'data': None, 'data_dir': './data', 'data_module': None, 'data_set': <spotPython.data.diabetes.Diabetes object at 0x2b3313d90>, 'design': None, 'device': 'mps', 'devices': 1, 'enable_progress_bar': False, 'eval': None, 'fun_evals': inf, 'fun_repeats': 1, 'infill_criterion': 'y', 'k_folds': 3, 'log_level': 10, 'loss_function': None, 'lower': array([3. , 4. , 1. , 0. , 0. , 0. , 0.1, 2. , 0. ]), 'max_time': 30, 'metric_river': None, 'metric_sklearn': None, 'metric_torch': None, 'metric_params': {}, 'model_dict': {}, 'noise': False, 'n_points': 1, 'n_samples': None, 'num_workers': 0, 'ocba_delta': 0, 'optimizer': None, 'path': None, 'prep_model': None, 'save_model': False, 'seed': 123, 'show_batch_interval': 1000000, 'show_models': False, 'show_progress': True, 'shuffle': None, 'sigma': 0.0, 'spot_tensorboard_path': 'runs/spot_logs/032_p040025_2024-01-08_10-38-56', 'spot_writer': <torch.utils.tensorboard.writer.SummaryWriter object at 0x2b8473fd0>, 'target_column': None, 'test_seed': 1234, 'test_size': 0.1, 'tolerance_x': 1.4901161193847656e-08, 'train': None, 'test': None, 'task': None, 'upper': array([ 8.  ,  9.  ,  4.  ,  1.  , 11.  ,  0.25, 10.  ,  6.  ,  2.  ]), 'var_name': ['l1', 'epochs', 'batch_size', 'act_fn', 'optimizer', 'dropout_prob', 'lr_mult', 'patience', 'initialization'], 'var_type': ['int', 'int', 'int', 'factor', 'factor', 'float', 'float', 'int', 'factor'], 'weights': 1.0, 'core_model': <class 'userrnn.RNNLightRegression'>, 'core_model_hyper_dict': {'l1': {'type': 'int', 'default': 3, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 7}, 'epochs': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 10, 'upper': 13}, 'batch_size': {'type': 'int', 'default': 4, 'transform': 'transform_power_2_int', 'lower': 2, 'upper': 6}, 'act_fn': {'levels': ['ReLU'], 'type': 'factor', 'default': 'ReLU', 'transform': 'None', 'class_name': 'spotPython.torch.activation', 'core_model_parameter_type': 'instance()', 'lower': 0, 'upper': 0}, 'optimizer': {'levels': ['Adadelta', 'Adagrad', 'Adam', 'AdamW', 'Adamax'], 'type': 'factor', 'default': 'SGD', 'transform': 'None', 'class_name': 'torch.optim', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 4}, 'dropout_prob': {'type': 'float', 'default': 0.01, 'transform': 'None', 'lower': 0.01, 'upper': 0.25}, 'lr_mult': {'type': 'float', 'default': 1.0, 'transform': 'None', 'lower': 0.5, 'upper': 5.0}, 'patience': {'type': 'int', 'default': 2, 'transform': 'transform_power_2_int', 'lower': 5, 'upper': 8}, 'initialization': {'levels': ['Default', 'Kaiming', 'Xavier'], 'type': 'factor', 'default': 'Default', 'transform': 'None', 'core_model_parameter_type': 'str', 'lower': 0, 'upper': 2}}}
